<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Admin Login â€” GPTMart</title>
<style>
  :root{--bg:#050815;--panel:#0b1a36;--stroke:#16213a;--text:#e6ecff;--accent:#2c57c7}
  body{margin:0;height:100vh;display:grid;place-items:center;background:linear-gradient(180deg,var(--bg),#091229)}
  .card{width:min(92vw,420px);background:var(--panel);border:1px solid var(--stroke);border-radius:16px;padding:22px;color:var(--text)}
  .card h2{margin:0 0 12px}
  .input{width:100%;padding:12px;border-radius:12px;border:1px solid var(--stroke);background:#0b152c;color:var(--text)}
  .row{display:flex;gap:10px;justify-content:flex-end;margin-top:14px}
  .btn{padding:10px 14px;border-radius:12px;border:1px solid #1a2b5a;background:#1b2a55;color:#e7efff;font-weight:700;cursor:pointer}
  .btn.primary{background:var(--accent);border-color:#2e53b7}
  .msg{font-size:12px;opacity:.9;margin-top:8px}
</style>
</head>
<body>
  <form class="card" id="loginForm">
    <h2>Admin Login</h2>
    <input id="pin" class="input" type="password" placeholder="Enter PIN (e.g., 4545)" required />
    <div class="row">
      <a class="btn" href="/">Back</a>
      <button class="btn primary" type="submit" id="loginBtn">Login</button>
    </div>
    <div class="msg" id="msg"></div>
  </form>

<script>
const API_BASE='https://connector-320f.onrender.com';
document.getElementById('loginForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const pin=document.getElementById('pin').value.trim(); const msg=document.getElementById('msg');
  msg.textContent='';
  document.getElementById('loginBtn').disabled=true;
  try{
    const r=await fetch(`${API_BASE}/api/login`,{
      method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include',
      body:JSON.stringify({ pin })
    });
    if(!r.ok) throw new Error(await r.text());
    const data=await r.json();
    localStorage.setItem('token', data.token);
    location.href='/admin.html';
  }catch(err){ msg.textContent='Login failed. Check your PIN and try again.'; }
  finally{ document.getElementById('loginBtn').disabled=false; }
});
</script>
</body>
</html>
