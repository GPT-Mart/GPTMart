<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GPTMart Admin</title>
<style>
  body{background:#050815;color:#e6ecff;font-family:Inter,system-ui;margin:0;padding:20px;}
  .tab{display:flex;gap:10px;margin-bottom:20px;}
  button{padding:10px 16px;border:none;border-radius:10px;cursor:pointer;font-weight:600;}
  button.active{background:#3b82f6;color:white;}
  .panel{display:none;}
  table{width:100%;border-collapse:collapse;margin-top:10px;}
  th,td{border:1px solid #1a2c5c;padding:8px;text-align:left;}
</style>
</head>
<body>
<h2>‚öôÔ∏è GPTMart Admin Panel</h2>
<div class="tab">
  <button id="tabGpts" class="active">GPTs</button>
  <button id="tabLeads">Leads</button>
</div>

<div id="panelGpts" class="panel" style="display:block;">
  <p>Existing GPTs appear here (existing admin functionality remains).</p>
</div>

<div id="panelLeads" class="panel">
  <h3>üì® User Leads</h3>
  <table id="leadsTable">
    <thead><tr><th>Email</th><th>Message</th><th>Date</th></tr></thead>
    <tbody></tbody>
  </table>
</div>

<script>
const API_BASE="https://connector-320f.onrender.com";
const TOKEN=localStorage.getItem('admintoken');
const tabG=document.getElementById('tabGpts'),tabL=document.getElementById('tabLeads');
const panelG=document.getElementById('panelGpts'),panelL=document.getElementById('panelLeads');

tabG.onclick=()=>{tabG.classList.add('active');tabL.classList.remove('active');panelG.style.display='block';panelL.style.display='none';}
tabL.onclick=()=>{tabL.classList.add('active');tabG.classList.remove('active');panelL.style.display='block';panelG.style.display='none';loadLeads();}

async function loadLeads(){
  const r=await fetch(`${API_BASE}/api/leads`,{headers:{Authorization:`Bearer ${TOKEN}`}});
  if(!r.ok)return alert('Failed to load leads');
  const data=await r.json();
  const tbody=document.querySelector('#leadsTable tbody');
  tbody.innerHTML=data.items.map(x=>`<tr><td>${x.email}</td><td>${x.message}</td><td>${new Date(x.createdAt).toLocaleString()}</td></tr>`).join('');
}
</script>
</body>
</html>
